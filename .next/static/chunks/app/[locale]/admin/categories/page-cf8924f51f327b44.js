(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[465],{6054:function(e,t,a){Promise.resolve().then(a.bind(a,4968))},2207:function(e,t,a){"use strict";a.r(t);var s=a(5373),l={};for(var n in s)"default"!==n&&(l[n]=(function(e){return s[e]}).bind(0,n));a.d(t,l)},4968:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var s=a(5964),l=a(800),n=a(3499),r=a(3781),d=a(3678);let i={en_name:"",mm_name:"",slug:"",parentId:""};function o(){var e;let{ready:t,accessToken:a}=(0,r.m)(),[o,m]=(0,l.useState)(!0),[c,u]=(0,l.useState)(!1),[x,p]=(0,l.useState)(null),[h,g]=(0,l.useState)(""),[b,j]=(0,l.useState)([]),[f,N]=(0,l.useState)(null),[v,y]=(0,l.useState)(!1),[C,_]=(0,l.useState)(!1),[w,S]=(0,l.useState)(!1),[I,k]=(0,l.useState)(i),[E,M]=(0,l.useState)(i);(0,l.useEffect)(()=>{let e=!0;return m(!0),(0,d.kb)().then(t=>{e&&(j(t.items),p(null))}).catch(()=>{e&&p("Failed to load categories.")}).finally(()=>{e&&m(!1)}),()=>{e=!1}},[]);let q=(0,l.useMemo)(()=>{let e=new Map;return b.forEach(t=>e.set(t.id,t.en_name)),e},[b]),P=(0,l.useMemo)(()=>{let e=h.trim().toLowerCase();return e?b.filter(t=>{var a;return[t.en_name,t.mm_name,t.slug,null!==(a=t.parentId)&&void 0!==a?a:""].join(" ").toLowerCase().includes(e)}):b},[b,h]);async function D(){j((await (0,d.kb)()).items)}async function U(e){if(e.preventDefault(),!a){p("Admin session not found. Please login again.");return}u(!0),p(null);try{await (0,d.kB)({en_name:I.en_name.trim(),mm_name:I.mm_name.trim(),slug:I.slug.trim(),parentId:I.parentId||void 0},a),await D(),y(!1),k(i)}catch(e){p("Failed to create category. Check name/slug uniqueness.")}finally{u(!1)}}async function Z(e){if(e.preventDefault(),a&&f){u(!0),p(null);try{let e=await (0,d.WZ)(f.id,{en_name:E.en_name.trim(),mm_name:E.mm_name.trim(),slug:E.slug.trim(),parentId:E.parentId||void 0},a);j(t=>t.map(t=>t.id===e.id?e:t)),N(e),S(!1)}catch(e){p("Failed to update category.")}finally{u(!1)}}}return(0,s.jsxs)("section",{className:"rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-xl font-semibold text-slate-900",children:"Product Categories"}),(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"Admin can create/update/detail category tree."})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("span",{className:"rounded-full border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:[P.length," category(s)"]}),(0,s.jsx)("button",{className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white",onClick:()=>y(!0),type:"button",children:"Create Category"})]})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)("input",{className:"w-full max-w-sm rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Search category by en/mm name or slug",value:h,onChange:e=>g(e.target.value)})}),x?(0,s.jsx)("p",{className:"mt-3 text-sm text-red-700",children:x}):null,(0,s.jsx)("div",{className:"mt-4 overflow-x-auto rounded-xl border border-slate-200",children:(0,s.jsxs)("table",{className:"w-full min-w-[820px] border-collapse",children:[(0,s.jsx)("thead",{className:"bg-slate-50",children:(0,s.jsxs)("tr",{className:"text-left text-xs uppercase tracking-wide text-slate-500",children:[(0,s.jsx)("th",{className:"px-3 py-3",children:"#"}),(0,s.jsx)("th",{className:"px-3 py-3",children:"EN Name"}),(0,s.jsx)("th",{className:"px-3 py-3",children:"MM Name"}),(0,s.jsx)("th",{className:"px-3 py-3",children:"Slug"}),(0,s.jsx)("th",{className:"px-3 py-3",children:"Parent"}),(0,s.jsx)("th",{className:"px-3 py-3",children:"Action"})]})}),(0,s.jsxs)("tbody",{children:[P.map((e,t)=>{var a;return(0,s.jsxs)("tr",{className:"border-t border-slate-100 text-sm text-slate-700",children:[(0,s.jsx)("td",{className:"px-3 py-3",children:t+1}),(0,s.jsx)("td",{className:"px-3 py-3 font-medium text-slate-900",children:e.en_name}),(0,s.jsx)("td",{className:"px-3 py-3",children:e.mm_name}),(0,s.jsx)("td",{className:"px-3 py-3",children:e.slug}),(0,s.jsx)("td",{className:"px-3 py-3",children:e.parentId?null!==(a=q.get(e.parentId))&&void 0!==a?a:e.parentId:"-"}),(0,s.jsx)("td",{className:"px-3 py-3",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("button",{className:"rounded-md border border-slate-300 px-3 py-1 text-xs font-medium text-slate-700",onClick:()=>{N(e),_(!0)},type:"button",children:"Detail"}),(0,s.jsx)("button",{className:"rounded-md border border-blue-500 px-3 py-1 text-xs font-medium text-blue-700",onClick:()=>{var t;N(e),M({en_name:e.en_name,mm_name:e.mm_name,slug:e.slug,parentId:null!==(t=e.parentId)&&void 0!==t?t:""}),S(!0)},type:"button",children:"Update"})]})})]},e.id)}),o||0!==P.length?null:(0,s.jsx)("tr",{children:(0,s.jsx)("td",{className:"px-3 py-6 text-sm text-slate-500",colSpan:6,children:"No categories found."})})]})]})}),(0,s.jsx)(n.Z,{open:v,title:"Create Category",onClose:()=>y(!1),children:(0,s.jsxs)("form",{className:"grid gap-3 md:grid-cols-2",onSubmit:U,children:[(0,s.jsx)("input",{className:"rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Category EN name",required:!0,value:I.en_name,onChange:e=>k(t=>({...t,en_name:e.target.value}))}),(0,s.jsx)("input",{className:"rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Category MM name",required:!0,value:I.mm_name,onChange:e=>k(t=>({...t,mm_name:e.target.value}))}),(0,s.jsx)("input",{className:"rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Slug",required:!0,value:I.slug,onChange:e=>k(t=>({...t,slug:e.target.value}))}),(0,s.jsxs)("select",{className:"rounded-lg border border-slate-300 px-3 py-2 text-sm md:col-span-2",value:I.parentId,onChange:e=>k(t=>({...t,parentId:e.target.value})),children:[(0,s.jsx)("option",{value:"",children:"No parent"}),b.map(e=>(0,s.jsx)("option",{value:e.id,children:e.en_name},e.id))]}),(0,s.jsxs)("div",{className:"md:col-span-2 flex justify-end gap-2",children:[(0,s.jsx)("button",{className:"rounded-lg border border-slate-300 px-4 py-2 text-sm font-medium text-slate-700",onClick:()=>y(!1),type:"button",children:"Cancel"}),(0,s.jsx)("button",{className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white disabled:opacity-60",disabled:!t||c,type:"submit",children:c?"Saving...":"Create"})]})]})}),(0,s.jsx)(n.Z,{open:C,title:"Category Detail",onClose:()=>_(!1),children:f?(0,s.jsxs)("div",{className:"grid gap-3 text-sm text-slate-700",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"EN Name"}),(0,s.jsx)("p",{className:"font-medium text-slate-900",children:f.en_name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"MM Name"}),(0,s.jsx)("p",{className:"font-medium text-slate-900",children:f.mm_name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"Slug"}),(0,s.jsx)("p",{children:f.slug})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"Parent"}),(0,s.jsx)("p",{children:f.parentId?null!==(e=q.get(f.parentId))&&void 0!==e?e:f.parentId:"-"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"Category ID"}),(0,s.jsx)("p",{className:"break-all",children:f.id})]})]}):null}),(0,s.jsx)(n.Z,{open:w,title:"Update Category",onClose:()=>S(!1),children:(0,s.jsxs)("form",{className:"grid gap-3 md:grid-cols-2",onSubmit:Z,children:[(0,s.jsx)("input",{className:"rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Category EN name",required:!0,value:E.en_name,onChange:e=>M(t=>({...t,en_name:e.target.value}))}),(0,s.jsx)("input",{className:"rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Category MM name",required:!0,value:E.mm_name,onChange:e=>M(t=>({...t,mm_name:e.target.value}))}),(0,s.jsx)("input",{className:"rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Slug",required:!0,value:E.slug,onChange:e=>M(t=>({...t,slug:e.target.value}))}),(0,s.jsxs)("select",{className:"rounded-lg border border-slate-300 px-3 py-2 text-sm md:col-span-2",value:E.parentId,onChange:e=>M(t=>({...t,parentId:e.target.value})),children:[(0,s.jsx)("option",{value:"",children:"No parent"}),b.filter(e=>e.id!==(null==f?void 0:f.id)).map(e=>(0,s.jsx)("option",{value:e.id,children:e.en_name},e.id))]}),(0,s.jsxs)("div",{className:"md:col-span-2 flex justify-end gap-2",children:[(0,s.jsx)("button",{className:"rounded-lg border border-slate-300 px-4 py-2 text-sm font-medium text-slate-700",onClick:()=>S(!1),type:"button",children:"Cancel"}),(0,s.jsx)("button",{className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white disabled:opacity-60",disabled:c,type:"submit",children:c?"Saving...":"Update"})]})]})})]})}},3499:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(5964);function l(e){let{open:t,title:a,onClose:l,children:n}=e;return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-start justify-center bg-slate-900/40 p-4 pt-16",children:(0,s.jsxs)("div",{className:"w-full max-w-2xl rounded-2xl border border-slate-200 bg-white shadow-2xl",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between border-b border-slate-200 px-5 py-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:a}),(0,s.jsx)("button",{className:"rounded-md border border-slate-300 px-3 py-1 text-sm text-slate-700 hover:bg-slate-100",onClick:l,type:"button",children:"Close"})]}),(0,s.jsx)("div",{className:"max-h-[75vh] overflow-y-auto p-5",children:n})]})}):null}},3781:function(e,t,a){"use strict";a.d(t,{m:function(){return d}});var s=a(800),l=a(6290),n=a(3178),r=a(2207);function d(){let e=(0,r.usePathname)(),[t,a]=(0,s.useState)(!1),[d,i]=(0,s.useState)(void 0),o=()=>{var e;i(null!==(e=(0,l.zf)(n.Qs))&&void 0!==e?e:void 0)};return(0,s.useEffect)(()=>{o(),a(!0)},[e]),(0,s.useEffect)(()=>{let e=()=>{o(),a(!0)};return window.addEventListener(n.UY,e),()=>{window.removeEventListener(n.UY,e)}},[]),{ready:t,accessToken:d}}}},function(e){e.O(0,[320,716,550,744],function(){return e(e.s=6054)}),_N_E=e.O()}]);