(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[679],{9968:function(e,t,s){Promise.resolve().then(s.bind(s,3180))},2207:function(e,t,s){"use strict";s.r(t);var l=s(5373),r={};for(var a in l)"default"!==a&&(r[a]=(function(e){return l[e]}).bind(0,a));s.d(t,r)},3180:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var l=s(5964),r=s(800),a=s(3499),n=s(3678),d=s(3781);let i={status:"",vendorId:"",userId:""};function c(){var e,t;let{ready:s,accessToken:c}=(0,d.m)(),[o,u]=(0,r.useState)(!0),[x,p]=(0,r.useState)(!1),[m,h]=(0,r.useState)(null),[j,f]=(0,r.useState)(null),[b,v]=(0,r.useState)(i),[N,y]=(0,r.useState)([]),[g,w]=(0,r.useState)(null),[S,I]=(0,r.useState)(!1),[R,C]=(0,r.useState)("");async function E(e,t){y((await (0,n.hs)({status:t.status||void 0,vendorId:t.vendorId||void 0,userId:t.userId||void 0,limit:100},e)).items)}async function D(){if(c){p(!0),h(null);try{await E(c,b)}catch(e){h("Failed to filter returns.")}finally{p(!1)}}}async function k(e){if(c){p(!0),h(null);try{let t=await (0,n.PZ)(e,c);w(t),I(!0)}catch(e){h("Failed to load return detail.")}finally{p(!1)}}}async function F(e){if(c){p(!0),h(null),f(null);try{if(await (0,n.RF)(e,R.trim()||void 0,c),await E(c,b),(null==g?void 0:g.id)===e){let t=await (0,n.PZ)(e,c);w(t)}f("Return ".concat(e," refunded."))}catch(e){h("Failed to refund return.")}finally{p(!1)}}}return(0,r.useEffect)(()=>{if(!s)return;if(!c){h("Admin session not found. Please login again."),u(!1);return}let e=!0;return u(!0),E(c,b).then(()=>{e&&h(null)}).catch(()=>{e&&h("Failed to load returns.")}).finally(()=>{e&&u(!1)}),()=>{e=!1}},[s,c]),(0,l.jsxs)("section",{className:"space-y-4 rounded-2xl border border-slate-200 bg-white p-5 shadow-sm",children:[(0,l.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-xl font-semibold text-slate-900",children:"Returns Oversight"}),(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"Review and refund received returns."})]}),(0,l.jsxs)("span",{className:"rounded-full border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:[N.length," return(s)"]})]}),(0,l.jsxs)("div",{className:"grid gap-2 md:grid-cols-4",children:[(0,l.jsx)("input",{className:"rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Status (REQUESTED...)",value:b.status,onChange:e=>v(t=>({...t,status:e.target.value}))}),(0,l.jsx)("input",{className:"rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"Vendor ID",value:b.vendorId,onChange:e=>v(t=>({...t,vendorId:e.target.value}))}),(0,l.jsx)("input",{className:"rounded-lg border border-slate-300 px-3 py-2 text-sm",placeholder:"User ID",value:b.userId,onChange:e=>v(t=>({...t,userId:e.target.value}))}),(0,l.jsx)("button",{className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white disabled:opacity-60",onClick:D,type:"button",disabled:x,children:"Search"})]}),m?(0,l.jsx)("p",{className:"text-sm text-red-700",children:m}):null,j?(0,l.jsx)("p",{className:"text-sm text-emerald-700",children:j}):null,(0,l.jsx)("div",{className:"overflow-x-auto rounded-xl border border-slate-200",children:(0,l.jsxs)("table",{className:"w-full min-w-[980px] border-collapse",children:[(0,l.jsx)("thead",{className:"bg-slate-50",children:(0,l.jsxs)("tr",{className:"text-left text-xs uppercase tracking-wide text-slate-500",children:[(0,l.jsx)("th",{className:"px-3 py-3",children:"Return"}),(0,l.jsx)("th",{className:"px-3 py-3",children:"Order"}),(0,l.jsx)("th",{className:"px-3 py-3",children:"Customer"}),(0,l.jsx)("th",{className:"px-3 py-3",children:"Vendor"}),(0,l.jsx)("th",{className:"px-3 py-3",children:"Status"}),(0,l.jsx)("th",{className:"px-3 py-3",children:"Requested"}),(0,l.jsx)("th",{className:"px-3 py-3",children:"Action"})]})}),(0,l.jsxs)("tbody",{children:[N.map(e=>{var t,s,r,a,n,d;return(0,l.jsxs)("tr",{className:"border-t border-slate-100 text-sm text-slate-700",children:[(0,l.jsxs)("td",{className:"px-3 py-3",children:[(0,l.jsx)("p",{className:"font-medium text-slate-900",children:e.id}),(0,l.jsx)("p",{className:"line-clamp-1 text-xs text-slate-500",children:e.reason})]}),(0,l.jsx)("td",{className:"px-3 py-3",children:e.order.id}),(0,l.jsx)("td",{className:"px-3 py-3",children:null!==(a=null===(t=e.order.user)||void 0===t?void 0:t.email)&&void 0!==a?a:"-"}),(0,l.jsx)("td",{className:"px-3 py-3",children:null!==(d=null!==(n=null===(s=e.order.vendor)||void 0===s?void 0:s.name)&&void 0!==n?n:null===(r=e.order.vendor)||void 0===r?void 0:r.id)&&void 0!==d?d:"-"}),(0,l.jsx)("td",{className:"px-3 py-3",children:e.status}),(0,l.jsx)("td",{className:"px-3 py-3",children:new Date(e.requestedAt).toLocaleString()}),(0,l.jsx)("td",{className:"px-3 py-3",children:(0,l.jsx)("button",{className:"rounded-md border border-slate-300 px-3 py-1 text-xs font-medium text-slate-700",onClick:()=>k(e.id),type:"button",disabled:x,children:"Detail"})})]},e.id)}),o||0!==N.length?null:(0,l.jsx)("tr",{children:(0,l.jsx)("td",{className:"px-3 py-6 text-sm text-slate-500",colSpan:7,children:"No returns found."})})]})]})}),(0,l.jsx)(a.Z,{open:S,title:"Return Detail",onClose:()=>I(!1),children:g?(0,l.jsxs)("div",{className:"space-y-3 text-sm text-slate-700",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"Return ID"}),(0,l.jsx)("p",{className:"break-all font-medium text-slate-900",children:g.id})]}),(0,l.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"Status"}),(0,l.jsx)("p",{children:g.status})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"Requested"}),(0,l.jsx)("p",{children:new Date(g.requestedAt).toLocaleString()})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"Order"}),(0,l.jsx)("p",{children:g.order.id})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"Total"}),(0,l.jsx)("p",{children:(e=g.order.total,t=g.order.currency,new Intl.NumberFormat("en-US",{style:"currency",currency:"MMK"===t?"MMK":"USD",maximumFractionDigits:"MMK"===t?0:2}).format(e/("USD"===t?100:1)))})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"Reason"}),(0,l.jsx)("p",{children:g.reason})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs uppercase text-slate-500",children:"Notes"}),(0,l.jsx)("p",{children:g.notes||"-"})]}),"RECEIVED"===g.status?(0,l.jsxs)("div",{className:"space-y-2 rounded-xl border border-amber-200 bg-amber-50 p-3",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"Refund this return"}),(0,l.jsx)("textarea",{className:"w-full rounded-lg border border-amber-200 bg-white px-3 py-2 text-sm",placeholder:"Refund note (optional)",rows:3,value:R,onChange:e=>C(e.target.value)}),(0,l.jsx)("button",{className:"rounded-lg bg-amber-600 px-3 py-1.5 text-xs font-semibold text-white disabled:opacity-60",type:"button",disabled:x,onClick:()=>F(g.id),children:"Refund now"})]}):null]}):null})]})}},3499:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});var l=s(5964);function r(e){let{open:t,title:s,onClose:r,children:a}=e;return t?(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-start justify-center bg-slate-900/40 p-4 pt-16",children:(0,l.jsxs)("div",{className:"w-full max-w-2xl rounded-2xl border border-slate-200 bg-white shadow-2xl",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between border-b border-slate-200 px-5 py-4",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:s}),(0,l.jsx)("button",{className:"rounded-md border border-slate-300 px-3 py-1 text-sm text-slate-700 hover:bg-slate-100",onClick:r,type:"button",children:"Close"})]}),(0,l.jsx)("div",{className:"max-h-[75vh] overflow-y-auto p-5",children:a})]})}):null}},3781:function(e,t,s){"use strict";s.d(t,{m:function(){return d}});var l=s(800),r=s(6290),a=s(3178),n=s(2207);function d(){let e=(0,n.usePathname)(),[t,s]=(0,l.useState)(!1),[d,i]=(0,l.useState)(void 0),c=()=>{var e;i(null!==(e=(0,r.zf)(a.Qs))&&void 0!==e?e:void 0)};return(0,l.useEffect)(()=>{c(),s(!0)},[e]),(0,l.useEffect)(()=>{let e=()=>{c(),s(!0)};return window.addEventListener(a.UY,e),()=>{window.removeEventListener(a.UY,e)}},[]),{ready:t,accessToken:d}}}},function(e){e.O(0,[320,716,550,744],function(){return e(e.s=9968)}),_N_E=e.O()}]);