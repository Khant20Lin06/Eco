(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[124],{1907:function(e,t,n){Promise.resolve().then(n.bind(n,2539))},2539:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var s=n(5964),l=n(4141),r=n(800),a=n(2207),i=n(3678),d=n(6519),c=n(8440),o=n(3808),u=n(6952);function f(e){let{filled:t}=e;return(0,s.jsx)("svg",{"aria-hidden":"true",className:"h-4 w-4",fill:t?"currentColor":"none",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"m20.84 4.61-.01-.01a5.5 5.5 0 0 0-7.78 0L12 5.65l-1.05-1.04a5.5 5.5 0 0 0-7.78 7.78l1.05 1.04L12 21l7.78-7.57 1.05-1.04a5.5 5.5 0 0 0 .01-7.78z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.8"})})}function m(e){var t,n,m,x;let{params:{locale:h}}=e,p=(0,a.useSearchParams)(),v=(0,a.useRouter)(),b=null!==(t=p.get("categoryId"))&&void 0!==t?t:"",g=null!==(n=p.get("q"))&&void 0!==n?n:"",{accessToken:j}=(0,c._)(),[y,N]=(0,r.useState)(!0),[w,S]=(0,r.useState)(null),[C,k]=(0,r.useState)(null),[M,E]=(0,r.useState)([]),[_,K]=(0,r.useState)([]),[L,F]=(0,r.useState)([]),[P,U]=(0,r.useState)([]),[A,D]=(0,r.useState)(null),[I,Q]=(0,r.useState)((0,u.CJ)()),[W,z]=(0,r.useState)(g),[R,Z]=(0,r.useState)(b),[J,O]=(0,r.useState)("");(0,r.useEffect)(()=>{Z(b)},[b]),(0,r.useEffect)(()=>{z(g)},[g]),(0,r.useEffect)(()=>{let e=!0;return N(!0),Promise.all([(0,i.tr)({limit:30,locale:h}),(0,i.kb)({locale:h}),(0,i.rw)({locale:h})]).then(t=>{let[n,s,l]=t;e&&(E(n.items),K(s.items),F(l.items),S(null))}).catch(()=>{e&&S("Failed to load products")}).finally(()=>{e&&N(!1)}),()=>{e=!1}},[]),(0,r.useEffect)(()=>{if(!j){U([]);return}let e=!0;return(0,i.FS)(j).then(t=>{e&&U(t.items.map(e=>e.productId))}).catch(()=>{e&&U([])}),()=>{e=!1}},[j]),(0,r.useEffect)(()=>{let e=e=>{let t=e.detail;Q((0,u.FK)(t))};return window.addEventListener(u.jW,e),()=>{window.removeEventListener(u.jW,e)}},[]);let V=(0,r.useMemo)(()=>M.filter(e=>{var t,n;let s=!W||"".concat(e.title," ").concat(e.description).toLowerCase().includes(W.toLowerCase()),l=!R||e.categoryId===R,r=!J||(null!==(n=e.tags)&&void 0!==n?n:[]).some(e=>e.tagId===J),a=(0,u.FK)(null===(t=e.variants[0])||void 0===t?void 0:t.currency)===I;return s&&l&&r&&a}),[M,W,R,J,I]);async function Y(e){if(A&&j)try{await (0,i._7)(e,j),(0,o.t)(),k('Added "'.concat(A.title,'" to cart')),D(null),v.push("/".concat(h,"/cart"))}catch(e){e instanceof Error&&e.message.includes("409")?(k("Single-vendor cart only. Clear cart first."),D(null),v.push("/".concat(h,"/cart"))):k("Failed to add item")}}async function q(e){if(!j){k("Please login first."),v.push("/".concat(h,"/login"));return}let t=P.includes(e.id);try{t?(await (0,i.Q9)(e.id,j),U(t=>t.filter(t=>t!==e.id)),(0,o.t)(),k("Removed from wishlist")):(await (0,i.Ln)(e.id,j),U(t=>[...t,e.id]),(0,o.t)(),k("Saved to wishlist"))}catch(e){k("Failed to update wishlist")}}return(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"surface p-5",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold text-[#181f46]",children:"Discover Sustainable Products"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-[#5d6486]",children:"Search by keyword, category and sustainability tags."})]}),(0,s.jsx)(l.default,{className:"btn-secondary rounded-lg px-4 py-2 text-sm font-semibold",href:"/".concat(h,"/cart"),children:"Go To Cart"})]}),(0,s.jsxs)("div",{className:"mt-4 grid gap-3 md:grid-cols-4",children:[(0,s.jsx)("input",{className:"rounded-lg border border-[#d3dcff] bg-white px-3 py-2 text-sm",placeholder:"Search product name or detail",value:W,onChange:e=>z(e.target.value)}),(0,s.jsxs)("select",{className:"rounded-lg border border-[#d3dcff] bg-white px-3 py-2 text-sm",value:R,onChange:e=>Z(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"All categories"}),_.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsxs)("select",{className:"rounded-lg border border-[#d3dcff] bg-white px-3 py-2 text-sm",value:J,onChange:e=>O(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"All tags"}),L.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,s.jsxs)("div",{className:"rounded-lg border border-[#d3dcff] bg-[#f9fbff] px-3 py-2 text-sm text-[#42538f]",children:[V.length," product(s) - ",I]})]}),w?(0,s.jsx)("p",{className:"mt-3 text-sm text-red-700",children:w}):null,C?(0,s.jsx)("p",{className:"mt-2 text-sm text-[#24316a]",children:C}):null]}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-3",children:V.map(e=>{var t,n,r,a,i;let d=e.variants[0],c=null===(t=e.images[0])||void 0===t?void 0:t.url,o=P.includes(e.id);return(0,s.jsxs)("article",{className:"surface overflow-hidden",children:[(0,s.jsxs)("div",{className:"relative h-44 w-full bg-gradient-to-br from-[#ffe7ed] to-[#e7ecff]",children:[(0,s.jsx)("button",{"aria-label":o?"Remove from wishlist":"Save to wishlist",className:"absolute right-3 top-3 z-10 inline-flex h-9 w-9 items-center justify-center rounded-full border backdrop-blur ".concat(o?"border-[#ffb0be] bg-[#fff2f5] text-[#d93a54]":"border-white/70 bg-white/85 text-[#33417b]"),onClick:()=>q(e),type:"button",children:(0,s.jsx)(f,{filled:o})}),c?(0,s.jsx)("img",{alt:e.title,className:"h-full w-full object-cover",src:c}):(0,s.jsx)("div",{className:"grid h-full place-items-center text-xs text-[#6b749c]",children:"No image"})]}),(0,s.jsxs)("div",{className:"space-y-3 p-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"line-clamp-1 text-base font-semibold text-[#1b2148]",children:e.title}),(0,s.jsx)("p",{className:"mt-1 line-clamp-2 text-sm text-[#5d6486]",children:e.description})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:(null!==(n=e.tags)&&void 0!==n?n:[]).slice(0,3).map(e=>{var t,n;return(0,s.jsx)("span",{className:"chip bg-[#f1f5ff] text-[#455599]",children:null!==(n=null===(t=e.tag)||void 0===t?void 0:t.name)&&void 0!==n?n:"tag"},e.id)})}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-[#19235f]",children:d?(a=d.price,i=d.currency,new Intl.NumberFormat("en-US",{style:"currency",currency:"MMK"===i?"MMK":"USD",maximumFractionDigits:"MMK"===i?0:2}).format(a/("USD"===i?100:1))):"-"}),(0,s.jsxs)("span",{className:"text-xs text-[#5d6486]",children:["Stock ",null!==(r=null==d?void 0:d.stockQty)&&void 0!==r?r:0]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,s.jsx)(l.default,{className:"rounded-lg border border-[#c9d6ff] px-3 py-2 text-center text-sm font-medium text-[#3d4d95]",href:"/".concat(h,"/product/").concat(e.id),children:"Detail"}),(0,s.jsx)("button",{className:"rounded-lg border border-[#c9d6ff] bg-white px-3 py-2 text-sm font-semibold text-[#3d4d95]",onClick:()=>q(e),type:"button",children:o?"Saved":"Save"}),(0,s.jsx)("button",{className:"btn-primary rounded-lg px-3 py-2 text-sm font-semibold",onClick:()=>(function(e){if(!j){k("Please login as customer/vendor first."),v.push("/".concat(h,"/login"));return}if(0===e.variants.length){k("No purchasable variant.");return}D(e)})(e),type:"button",children:"Add Cart"})]})]})]},e.id)})}),y||0!==V.length?null:(0,s.jsx)("div",{className:"surface p-8 text-center text-sm text-[#5d6486]",children:"No products found."}),(0,s.jsx)(d.Z,{locale:h,onClose:()=>D(null),onConfirm:Y,open:!!A,title:null!==(m=null==A?void 0:A.title)&&void 0!==m?m:"",variants:null!==(x=null==A?void 0:A.variants)&&void 0!==x?x:[]})]})}},6519:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var s=n(5964),l=n(800);function r(e){var t,n,r,a;let{open:i,title:d,variants:c,locale:o,onClose:u,onConfirm:f}=e,[m,x]=(0,l.useState)({}),[h,p]=(0,l.useState)(1),[v,b]=(0,l.useState)(!1),g=(0,l.useMemo)(()=>(function(e){let t=new Map;for(let l of e){var n,s;for(let e of null!==(n=l.options)&&void 0!==n?n:[])t.has(e.name)||t.set(e.name,new Set),null===(s=t.get(e.name))||void 0===s||s.add(e.value)}return Array.from(t.entries()).map(e=>{let[t,n]=e;return{name:t,values:Array.from(n)}})})(c),[c]),j=(0,l.useMemo)(()=>{var e;return null!==(e=c.find(e=>0===g.length||g.every(t=>{var n;let s=m[t.name];if(!s)return!1;let l=(null!==(n=e.options)&&void 0!==n?n:[]).find(e=>e.name===t.name);return(null==l?void 0:l.value)===s})))&&void 0!==e?e:0===g.length?c[0]:void 0},[g,m,c]);if((0,l.useEffect)(()=>{if(!i)return;let e={},t=c[0];for(let r of g){var n,s,l;let a=null!==(l=null==t?void 0:null===(s=t.options)||void 0===s?void 0:null===(n=s.find(e=>e.name===r.name))||void 0===n?void 0:n.value)&&void 0!==l?l:r.values[0];a&&(e[r.name]=a)}x(e),p(1)},[i,g,c]),!i)return null;let y=null!==(t=null==j?void 0:j.stockQty)&&void 0!==t?t:0;return(0,s.jsx)("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/45 px-4",onClick:u,children:(0,s.jsxs)("div",{className:"w-full max-w-lg rounded-2xl border border-[#dce3ff] bg-white p-5 shadow-[0_24px_60px_rgba(0,0,0,0.25)]",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-[#1b2452]",children:"Choose Variant"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-[#5d6486] line-clamp-1",children:d})]}),(0,s.jsx)("button",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-[#d4dcff] text-[#4e5b8c]",onClick:u,type:"button",children:"\xd7"})]}),(0,s.jsxs)("div",{className:"mt-4 space-y-3",children:[g.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-semibold text-[#2d396d]",children:e.name}),(0,s.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:e.values.map(t=>(0,s.jsx)("button",{className:"rounded-full border px-3 py-1.5 text-xs font-semibold ".concat(m[e.name]===t?"border-[#3958c7] bg-[#3958c7] text-white":"border-[#d4ddff] bg-white text-[#2e3a6c]"),onClick:()=>x(n=>({...n,[e.name]:t})),type:"button",children:t},"".concat(e.name,"-").concat(t)))})]},e.name)),(0,s.jsxs)("div",{className:"grid gap-3 sm:grid-cols-[1fr_auto]",children:[(0,s.jsxs)("label",{className:"text-sm font-semibold text-[#2d396d]",children:["Quantity",(0,s.jsx)("input",{className:"mt-2 w-full rounded-xl border border-[#cad3ff] px-3 py-2 text-sm",min:1,max:y>0?y:void 0,onChange:e=>p(Number(e.target.value)),type:"number",value:h})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-[#d7e0ff] bg-[#f8faff] px-4 py-3",children:[(0,s.jsx)("p",{className:"text-xs text-[#60709e]",children:"Price"}),(0,s.jsx)("p",{className:"text-base font-semibold text-[#18214f]",children:j?(r=j.price,a=j.currency,new Intl.NumberFormat("my"===o?"my-MM":"en-US",{style:"currency",currency:"MMK"===a?"MMK":"USD",maximumFractionDigits:"MMK"===a?0:2}).format(r/("USD"===a?100:1))):"-"}),(0,s.jsxs)("p",{className:"mt-1 text-xs text-[#60709e]",children:["Stock ",null!==(n=null==j?void 0:j.stockQty)&&void 0!==n?n:0]})]})]})]}),(0,s.jsxs)("div",{className:"mt-5 flex justify-end gap-2",children:[(0,s.jsx)("button",{className:"rounded-lg border border-[#cad6ff] px-4 py-2 text-sm font-semibold text-[#3349ad]",onClick:u,type:"button",children:"Cancel"}),(0,s.jsx)("button",{className:"rounded-lg bg-[#3654c5] px-4 py-2 text-sm font-semibold text-white disabled:opacity-60",disabled:!j||y<=0||h<1||h>y||v,onClick:async()=>{if(j&&!(h<1)){b(!0);try{await f({variantId:j.id,qty:h})}finally{b(!1)}}},type:"button",children:v?"Adding...":"Add to bag"})]})]})})}},8440:function(e,t,n){"use strict";n.d(t,{_:function(){return i}});var s=n(800),l=n(6290),r=n(3178),a=n(2207);function i(){let e=(0,a.usePathname)(),[t,n]=(0,s.useState)(!1),[i,d]=(0,s.useState)(void 0),[c,o]=(0,s.useState)(null),u=()=>{var e;d(null!==(e=(0,l.zf)(r.Qs))&&void 0!==e?e:void 0),o((0,l.ZK)())};return(0,s.useEffect)(()=>{u(),n(!0)},[e]),(0,s.useEffect)(()=>{let e=()=>{u(),n(!0)};return window.addEventListener(r.UY,e),()=>{window.removeEventListener(r.UY,e)}},[]),{ready:t,accessToken:i,role:c}}},6952:function(e,t,n){"use strict";n.d(t,{CJ:function(){return a},FK:function(){return r},SK:function(){return i},jW:function(){return l}});let s="eco_currency",l="eco:currency-preference-changed";function r(e){return"MMK"===e?"MMK":"USD"}function a(){return r(function(e){if("undefined"==typeof document)return null;let t="".concat(e,"=");for(let e of document.cookie.split(";")){let n=e.trim();if(n.startsWith(t))return decodeURIComponent(n.slice(t.length))}return null}(s))}function i(e){"undefined"!=typeof document&&(document.cookie="".concat(s,"=").concat(e,"; Path=/; Max-Age=31536000; SameSite=Lax"),window.dispatchEvent(new CustomEvent(l,{detail:e})))}},3808:function(e,t,n){"use strict";n.d(t,{V:function(){return s},t:function(){return l}});let s="eco:header-counts-refresh";function l(){window.dispatchEvent(new Event(s))}}},function(e){e.O(0,[46,320,716,550,744],function(){return e(e.s=1907)}),_N_E=e.O()}]);