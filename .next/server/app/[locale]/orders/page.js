(()=>{var e={};e.id=369,e.ids=[369],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},612:e=>{"use strict";e.exports=require("node:os")},7742:e=>{"use strict";e.exports=require("node:process")},5997:e=>{"use strict";e.exports=require("node:tty")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},6224:e=>{"use strict";e.exports=require("tty")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},2434:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>x,tree:()=>d});var s=r(8149),a=r(2658),i=r(9457),n=r.n(i),l=r(9960),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d=["",{children:["[locale]",{children:["orders",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,2688)),"C:\\Users\\Admin\\OneDrive\\Desktop\\Project\\eco\\frontend\\src\\app\\[locale]\\orders\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,4208)),"C:\\Users\\Admin\\OneDrive\\Desktop\\Project\\eco\\frontend\\src\\app\\[locale]\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,6738)),"C:\\Users\\Admin\\OneDrive\\Desktop\\Project\\eco\\frontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7066,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\Admin\\OneDrive\\Desktop\\Project\\eco\\frontend\\src\\app\\[locale]\\orders\\page.tsx"],u="/[locale]/orders/page",p={require:r,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/[locale]/orders/page",pathname:"/[locale]/orders",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4289:(e,t,r)=>{Promise.resolve().then(r.bind(r,5050))},5050:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(241),a=r(8170),i=r(1662),n=r(4045),l=r(2999);function o(e,t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"MMK"===t?"MMK":"USD",maximumFractionDigits:"MMK"===t?0:2}).format(e/("USD"===t?100:1))}function d({params:{locale:e}}){let{ready:t,accessToken:r}=(0,l._)(),[d,c]=(0,i.useState)(!0),[u,p]=(0,i.useState)(!1),[x,f]=(0,i.useState)(null),[m,h]=(0,i.useState)(null),[b,y]=(0,i.useState)([]),[g,N]=(0,i.useState)([]),[j,P]=(0,i.useState)(""),[v,w]=(0,i.useState)("");async function E(e){let[t,r]=await Promise.allSettled([(0,n.Vi)(e),(0,n.hh)(e)]);if("fulfilled"===t.status)y(t.value.items);else throw t.reason;"fulfilled"===r.status?N(r.value.items):N([])}(0,i.useEffect)(()=>{if(!t)return;if(!r){f("Please login to view your orders."),c(!1);return}let e=!0;return c(!0),E(r).then(()=>{e&&f(null)}).catch(()=>{e&&f("Failed to load orders.")}).finally(()=>{e&&c(!1)}),()=>{e=!1}},[t,r]);let D=(0,i.useMemo)(()=>{let e=new Set(["REQUESTED","APPROVED","RECEIVED"]);return new Set(g.filter(t=>e.has(t.status)).map(e=>e.order.id))},[g]);async function q(e){if(r){p(!0),f(null),h(null);try{await (0,n.E7)(e.id,"CANCELED",r),await E(r),h(`Order ${e.id} canceled.`)}catch{f("Failed to cancel order.")}finally{p(!1)}}}async function C(e){if(r){p(!0),f(null),h(null);try{if("USD"===e.currency){let t=await (0,n.DF)(e.id,r);if(t.url){window.location.href=t.url;return}}else await (0,n.vp)(e.id,r);await E(r),h(`Payment completed for order ${e.id}.`)}catch{f("Failed to process payment.")}finally{p(!1)}}}async function _(e,t){if(r){p(!0),f(null),h(null);try{"WAVE"===t?await (0,n.vp)(e.id,r):await (0,n.HP)(e.id,r),await E(r),h(`Payment completed for order ${e.id}.`)}catch{f("Failed to process payment.")}finally{p(!1)}}}async function A(e){if(r&&v.trim()){p(!0),f(null),h(null);try{await (0,n.WG)({orderId:e,reason:v.trim()},r),await E(r),P(""),w(""),h("Return requested.")}catch{f("Failed to request return.")}finally{p(!1)}}}return(0,s.jsxs)("section",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"surface p-5 md:p-6",children:[s.jsx("h1",{className:"text-2xl font-semibold text-[#181f46]",children:"Order History"}),s.jsx("p",{className:"mt-1 text-sm text-[#5d6486]",children:"Track payments, status transitions, and returns."})]}),x?s.jsx("div",{className:"surface border-[#ffd7dd] bg-[#fff5f6] p-4 text-sm text-[#b12f43]",children:x}):null,m?s.jsx("div",{className:"surface border-[#d1eeda] bg-[#f1fbf4] p-4 text-sm text-[#17724b]",children:m}):null,d?s.jsx("div",{className:"surface p-4 text-sm text-[#5d6486]",children:"Loading orders..."}):0===b.length?s.jsx("div",{className:"surface p-4 text-sm text-[#5d6486]",children:"No orders yet."}):s.jsx("div",{className:"space-y-3",children:b.map(t=>{var r;let i="PENDING_PAYMENT"===t.status||"PAID"===t.status,n="DELIVERED"===t.status||"PICKED_UP"===t.status,l=D.has(t.id),d="PENDING_PAYMENT"===t.status&&"MMK"===t.currency;return(0,s.jsxs)("article",{className:"surface p-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"text-xs uppercase tracking-wide text-[#6371a8]",children:["Order #",t.id]}),s.jsx("h2",{className:"mt-1 text-lg font-semibold text-[#1a224e]",children:o(t.total,t.currency)}),(0,s.jsxs)("p",{className:"text-sm text-[#5d6486]",children:[t.fulfillment," â€¢ ",new Date(t.createdAt).toLocaleString()]})]}),s.jsx("span",{className:"PAID"===(r=t.status)||"DELIVERED"===r||"PICKED_UP"===r?"chip chip-success":r.includes("RETURN")||"REFUNDED"===r?"chip chip-warn":"CANCELED"===r?"chip chip-danger":"chip bg-[#eff4ff] text-[#4c5d9f]",children:t.status})]}),s.jsx("div",{className:"mt-3 space-y-2",children:(t.items??[]).map(e=>(0,s.jsxs)("div",{className:"rounded-xl border border-[#d8e1ff] bg-[#fbfcff] px-3 py-2 text-sm",children:[s.jsx("p",{className:"font-medium text-[#1f2858]",children:e.variant.product?.title??"Product"}),(0,s.jsxs)("p",{className:"text-[#60709d]",children:[e.qty," x ",o(e.unitPrice,t.currency)]})]},e.id))}),(0,s.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2",children:[s.jsx(a.default,{className:"rounded-lg border border-[#c6d5ff] bg-white px-3 py-1.5 text-xs font-semibold text-[#3349ad]",href:`/${e}/chat?orderId=${t.id}`,children:"Open chat"}),"PENDING_PAYMENT"===t.status?s.jsx(s.Fragment,{children:"USD"===t.currency?s.jsx("button",{className:"btn-primary rounded-lg px-3 py-1.5 text-xs font-semibold",onClick:()=>C(t),type:"button",disabled:u,children:"Pay with Stripe"}):(0,s.jsxs)(s.Fragment,{children:[s.jsx("button",{className:"btn-secondary rounded-lg px-3 py-1.5 text-xs font-semibold",onClick:()=>_(t,"WAVE"),type:"button",disabled:u,children:"Pay with Wave"}),s.jsx("button",{className:"rounded-lg border border-[#bcd1ff] bg-white px-3 py-1.5 text-xs font-semibold text-[#3550c0]",onClick:()=>_(t,"KBZPAY"),type:"button",disabled:u,children:"Pay with KBZPay"})]})}):null,i?s.jsx("button",{className:"rounded-lg border border-[#ffc2cd] bg-white px-3 py-1.5 text-xs font-semibold text-[#c33f53]",onClick:()=>q(t),type:"button",disabled:u,children:"Cancel order"}):null]}),n?s.jsx("div",{className:"mt-4 rounded-xl border border-[#d8e1ff] bg-[#f8faff] p-3",children:l?s.jsx("p",{className:"text-sm text-[#59648f]",children:"Return already in progress."}):j===t.id?(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx("textarea",{className:"w-full rounded-xl border border-[#cfd9ff] bg-white px-3 py-2 text-sm",value:v,onChange:e=>w(e.target.value),placeholder:"Why are you returning this order?",rows:3}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx("button",{className:"btn-primary rounded-lg px-3 py-1.5 text-xs font-semibold",type:"button",onClick:()=>A(t.id),disabled:u,children:"Submit return"}),s.jsx("button",{className:"rounded-lg border border-[#cfd9ff] bg-white px-3 py-1.5 text-xs font-semibold text-[#44539a]",type:"button",onClick:()=>{P(""),w("")},children:"Cancel"})]})]}):s.jsx("button",{className:"rounded-lg border border-[#c6d5ff] bg-white px-3 py-1.5 text-xs font-semibold text-[#3349ad]",type:"button",onClick:()=>P(t.id),children:"Request return"})}):null,d?s.jsx("p",{className:"mt-2 text-xs text-[#5d6486]",children:"MMK mock payment is enabled for MVP."}):null]},t.id)})})]})}},2688:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>i,__esModule:()=>a,default:()=>n});let s=(0,r(3596).createProxy)(String.raw`C:\Users\Admin\OneDrive\Desktop\Project\eco\frontend\src\app\[locale]\orders\page.tsx`),{__esModule:a,$$typeof:i}=s,n=s.default}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[563,851,482,382],()=>r(2434));module.exports=s})();